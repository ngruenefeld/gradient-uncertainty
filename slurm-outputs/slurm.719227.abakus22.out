slurmstepd-abakus22: error: Unable to create TMPDIR [/tmp/user/24470]: Permission denied
slurmstepd-abakus22: error: Setting TMPDIR to /tmp
Running job with commit: 8ee656841dcd573daafd21db616be4cc2b2e60d6
Running command: python -um scripts.bert "719227" --key_mode "keyfile" --sample_size "100"
Job number: 719227
Key mode: keyfile
Sample size: 100
Using 100 samples from the dataset.
BertForMaskedLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From ðŸ‘‰v4.50ðŸ‘ˆ onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertForMaskedLM: ['bert.pooler.dense.bias', 'bert.pooler.dense.weight', 'cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Using device: cuda
/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/scripts/bert.py:103: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
In-Domain Sentence: The basketball game was intense and exciting.
Out-Of-Domain Sentence: The patient was diagnosed with colon cancer.
  0%|          | 0/21 [00:00<?, ?it/s]  5%|â–         | 1/21 [00:00<00:16,  1.21it/s] 10%|â–‰         | 2/21 [00:01<00:08,  2.26it/s] 19%|â–ˆâ–‰        | 4/21 [00:01<00:03,  4.94it/s] 29%|â–ˆâ–ˆâ–Š       | 6/21 [00:01<00:02,  7.39it/s] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 8/21 [00:01<00:01,  9.80it/s] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 10/21 [00:01<00:00, 11.48it/s] 57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 12/21 [00:01<00:00, 12.78it/s] 71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 15/21 [00:01<00:00, 15.04it/s] 81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 17/21 [00:01<00:00, 15.40it/s] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 19/21 [00:01<00:00, 15.66it/s]                                               {'train_runtime': 2.0953, 'train_samples_per_second': 143.177, 'train_steps_per_second': 10.022, 'train_loss': 2.668704804920015, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 21/21 [00:02<00:00, 15.66it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 21/21 [00:02<00:00, 10.03it/s]
In-Domain Uncertainty before fine-tuning: tensor(72.4593)
In-Domain Uncertainty after fine-tuning: tensor(96.5463)
Out-Of-Domain Uncertainty before fine-tuning: tensor(147.7263)
Out-Of-Domain Uncertainty after fine-tuning: tensor(162.1327)
In-Domain Difference: tensor(24.0871)
Out-Of-Domain Difference: tensor(14.4064)
