slurmstepd-abakus11: error: Unable to create TMPDIR [/tmp/user/24470]: Permission denied
slurmstepd-abakus11: error: Setting TMPDIR to /tmp
Running job with commit: 4deef060319d061be435d7bf90af18964dd144e8
Running command: python -um scripts.bert "719250" --key_mode "keyfile" --sample_size "10" --test_sample_size "101" --counterfactual "constant"
Job number: 719250
Key mode: keyfile
Sample size: 10
Normalize: False
Counterfactual: constant
Using 10 randomly sampled examples from the train dataset (all categories).
Using 101 randomly sampled examples from the test dataset (all categories).
BertForMaskedLM has generative capabilities, as `prepare_inputs_for_generation` is explicitly overwritten. However, it doesn't directly inherit from `GenerationMixin`. From ðŸ‘‰v4.50ðŸ‘ˆ onwards, `PreTrainedModel` will NOT inherit from `GenerationMixin`, and this model will lose the ability to call `generate` and other related functions.
  - If you're using `trust_remote_code=True`, you can get rid of this warning by loading the model with an auto class. See https://huggingface.co/docs/transformers/en/model_doc/auto#auto-classes
  - If you are the owner of the model architecture code, please modify your model class such that it inherits from `GenerationMixin` (after `PreTrainedModel`, otherwise you'll get an exception).
  - If you are not the owner of the model architecture class, please contact the model code owner to update it.
Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertForMaskedLM: ['bert.pooler.dense.bias', 'bert.pooler.dense.weight', 'cls.seq_relationship.bias', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertForMaskedLM from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertForMaskedLM from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Using device: cuda
Map:   0%|          | 0/10 [00:00<?, ? examples/s]Map: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 10/10 [00:00<00:00, 931.78 examples/s]
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/scripts/bert.py:199: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Calculating uncertainties for 101 test samples before training (counterfactual mode: constant)...
Processing test sample 1/101 (before training)
Processing test sample 2/101 (before training)
Processing test sample 3/101 (before training)
Processing test sample 4/101 (before training)
Processing test sample 5/101 (before training)
Processing test sample 6/101 (before training)
Processing test sample 7/101 (before training)
Processing test sample 8/101 (before training)
Processing test sample 9/101 (before training)
Processing test sample 10/101 (before training)
Processing test sample 11/101 (before training)
Processing test sample 12/101 (before training)
Processing test sample 13/101 (before training)
Processing test sample 14/101 (before training)
Processing test sample 15/101 (before training)
Processing test sample 16/101 (before training)
Processing test sample 17/101 (before training)
Processing test sample 18/101 (before training)
Processing test sample 19/101 (before training)
Processing test sample 20/101 (before training)
Processing test sample 21/101 (before training)
Processing test sample 22/101 (before training)
Processing test sample 23/101 (before training)
Processing test sample 24/101 (before training)
Processing test sample 25/101 (before training)
Processing test sample 26/101 (before training)
Processing test sample 27/101 (before training)
Processing test sample 28/101 (before training)
Processing test sample 29/101 (before training)
Processing test sample 30/101 (before training)
Processing test sample 31/101 (before training)
Processing test sample 32/101 (before training)
Processing test sample 33/101 (before training)
Processing test sample 34/101 (before training)
Processing test sample 35/101 (before training)
Processing test sample 36/101 (before training)
Processing test sample 37/101 (before training)
Processing test sample 38/101 (before training)
Processing test sample 39/101 (before training)
Processing test sample 40/101 (before training)
Processing test sample 41/101 (before training)
Processing test sample 42/101 (before training)
Processing test sample 43/101 (before training)
Processing test sample 44/101 (before training)
Processing test sample 45/101 (before training)
Processing test sample 46/101 (before training)
Processing test sample 47/101 (before training)
Processing test sample 48/101 (before training)
Processing test sample 49/101 (before training)
Processing test sample 50/101 (before training)
Processing test sample 51/101 (before training)
Processing test sample 52/101 (before training)
Processing test sample 53/101 (before training)
Processing test sample 54/101 (before training)
Processing test sample 55/101 (before training)
Processing test sample 56/101 (before training)
Processing test sample 57/101 (before training)
Processing test sample 58/101 (before training)
Processing test sample 59/101 (before training)
Processing test sample 60/101 (before training)
Processing test sample 61/101 (before training)
Processing test sample 62/101 (before training)
Processing test sample 63/101 (before training)
Processing test sample 64/101 (before training)
Processing test sample 65/101 (before training)
Processing test sample 66/101 (before training)
Processing test sample 67/101 (before training)
Processing test sample 68/101 (before training)
Processing test sample 69/101 (before training)
Processing test sample 70/101 (before training)
Processing test sample 71/101 (before training)
Processing test sample 72/101 (before training)
Processing test sample 73/101 (before training)
Processing test sample 74/101 (before training)
Processing test sample 75/101 (before training)
Processing test sample 76/101 (before training)
Processing test sample 77/101 (before training)
Processing test sample 78/101 (before training)
Processing test sample 79/101 (before training)
Processing test sample 80/101 (before training)
Processing test sample 81/101 (before training)
Processing test sample 82/101 (before training)
Processing test sample 83/101 (before training)
Processing test sample 84/101 (before training)
Processing test sample 85/101 (before training)
Processing test sample 86/101 (before training)
Processing test sample 87/101 (before training)
Processing test sample 88/101 (before training)
Processing test sample 89/101 (before training)
Processing test sample 90/101 (before training)
Processing test sample 91/101 (before training)
Processing test sample 92/101 (before training)
Processing test sample 93/101 (before training)
Processing test sample 94/101 (before training)
Processing test sample 95/101 (before training)
Processing test sample 96/101 (before training)
Processing test sample 97/101 (before training)
Processing test sample 98/101 (before training)
Processing test sample 99/101 (before training)
Processing test sample 100/101 (before training)
Processing test sample 101/101 (before training)
Training model...
  0%|          | 0/3 [00:00<?, ?it/s] 33%|â–ˆâ–ˆâ–ˆâ–Ž      | 1/3 [00:00<00:00,  5.53it/s] 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 2/3 [00:00<00:00,  7.09it/s]                                             {'train_runtime': 0.3613, 'train_samples_per_second': 83.023, 'train_steps_per_second': 8.302, 'train_loss': 3.7724761962890625, 'epoch': 3.0}
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  7.09it/s]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:00<00:00,  8.32it/s]
Calculating uncertainties for 101 test samples after training (counterfactual mode: constant)...
Processing test sample 1/101 (after training)
Processing test sample 2/101 (after training)
Processing test sample 3/101 (after training)
Processing test sample 4/101 (after training)
Processing test sample 5/101 (after training)
Processing test sample 6/101 (after training)
Processing test sample 7/101 (after training)
Processing test sample 8/101 (after training)
Processing test sample 9/101 (after training)
Processing test sample 10/101 (after training)
Processing test sample 11/101 (after training)
Processing test sample 12/101 (after training)
Processing test sample 13/101 (after training)
Processing test sample 14/101 (after training)
Processing test sample 15/101 (after training)
Processing test sample 16/101 (after training)
Processing test sample 17/101 (after training)
Processing test sample 18/101 (after training)
Processing test sample 19/101 (after training)
Processing test sample 20/101 (after training)
Processing test sample 21/101 (after training)
Processing test sample 22/101 (after training)
Processing test sample 23/101 (after training)
Processing test sample 24/101 (after training)
Processing test sample 25/101 (after training)
Processing test sample 26/101 (after training)
Processing test sample 27/101 (after training)
Processing test sample 28/101 (after training)
Processing test sample 29/101 (after training)
Processing test sample 30/101 (after training)
Processing test sample 31/101 (after training)
Processing test sample 32/101 (after training)
Processing test sample 33/101 (after training)
Processing test sample 34/101 (after training)
Processing test sample 35/101 (after training)
Processing test sample 36/101 (after training)
Processing test sample 37/101 (after training)
Processing test sample 38/101 (after training)
Processing test sample 39/101 (after training)
Processing test sample 40/101 (after training)
Processing test sample 41/101 (after training)
Processing test sample 42/101 (after training)
Processing test sample 43/101 (after training)
Processing test sample 44/101 (after training)
Processing test sample 45/101 (after training)
Processing test sample 46/101 (after training)
Processing test sample 47/101 (after training)
Processing test sample 48/101 (after training)
Processing test sample 49/101 (after training)
Processing test sample 50/101 (after training)
Processing test sample 51/101 (after training)
Processing test sample 52/101 (after training)
Processing test sample 53/101 (after training)
Processing test sample 54/101 (after training)
Processing test sample 55/101 (after training)
Processing test sample 56/101 (after training)
Processing test sample 57/101 (after training)
Processing test sample 58/101 (after training)
Processing test sample 59/101 (after training)
Processing test sample 60/101 (after training)
Processing test sample 61/101 (after training)
Processing test sample 62/101 (after training)
Processing test sample 63/101 (after training)
Processing test sample 64/101 (after training)
Processing test sample 65/101 (after training)
Processing test sample 66/101 (after training)
Processing test sample 67/101 (after training)
Processing test sample 68/101 (after training)
Processing test sample 69/101 (after training)
Processing test sample 70/101 (after training)
Processing test sample 71/101 (after training)
Processing test sample 72/101 (after training)
Processing test sample 73/101 (after training)
Processing test sample 74/101 (after training)
Processing test sample 75/101 (after training)
Processing test sample 76/101 (after training)
Processing test sample 77/101 (after training)
Processing test sample 78/101 (after training)
Processing test sample 79/101 (after training)
Processing test sample 80/101 (after training)
Processing test sample 81/101 (after training)
Processing test sample 82/101 (after training)
Processing test sample 83/101 (after training)
Processing test sample 84/101 (after training)
Processing test sample 85/101 (after training)
Processing test sample 86/101 (after training)
Processing test sample 87/101 (after training)
Processing test sample 88/101 (after training)
Processing test sample 89/101 (after training)
Processing test sample 90/101 (after training)
Processing test sample 91/101 (after training)
Processing test sample 92/101 (after training)
Processing test sample 93/101 (after training)
Processing test sample 94/101 (after training)
Processing test sample 95/101 (after training)
Processing test sample 96/101 (after training)
Processing test sample 97/101 (after training)
Processing test sample 98/101 (after training)
Processing test sample 99/101 (after training)
Processing test sample 100/101 (after training)
Processing test sample 101/101 (after training)

Processing complete. Saved 101 results. Failed: 0
