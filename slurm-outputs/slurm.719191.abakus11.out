slurmstepd-abakus11: error: Unable to create TMPDIR [/tmp/user/24470]: Permission denied
slurmstepd-abakus11: error: Setting TMPDIR to /tmp
Running job with commit: fa14fe89c7109c839249f4ec5425f2d078b5c076
Job number: 719191
Dataset: truthful
Model: llama-3.1-8b
GPT Model: gpt-4o-mini-2024-07-18
Key mode: keyfile
Sample size: 5
Mode: test
Streaming dataset: False
Quantization bits: 4
Full gradient: False
Response only: True
Normalize: True
Loading model in 4-bit precision to reduce memory usage
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:07,  2.64s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:05<00:05,  2.69s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:08<00:02,  2.68s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  1.88s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  2.17s/it]
Processing sample 1/5 (dataset index: 585)
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
0 tensor([[ 0.0012,  0.0057, -0.0033,  ...,  0.0041, -0.0026, -0.0007],
        [-0.0036,  0.0028, -0.0023,  ...,  0.0013, -0.0016, -0.0023],
        [ 0.0007, -0.0161,  0.0026,  ...,  0.0043,  0.0079,  0.0049],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0', dtype=torch.float16)
1 tensor([[ 0.0012,  0.0057, -0.0033,  ...,  0.0041, -0.0026, -0.0007],
        [-0.0035,  0.0021, -0.0020,  ...,  0.0011, -0.0017, -0.0022],
        [ 0.0007, -0.0161,  0.0026,  ...,  0.0043,  0.0079,  0.0049],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0', dtype=torch.float16)
2 0
Error in completion_gradient: 'int' object has no attribute 'norm'
Error calculating gradient for sample 1 (dataset index 585): 'int' object has no attribute 'norm'
Processing sample 2/5 (dataset index: 41)
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
0 tensor([[ 0.0012,  0.0057, -0.0033,  ...,  0.0041, -0.0026, -0.0007],
        [-0.0034,  0.0013, -0.0017,  ...,  0.0009, -0.0019, -0.0022],
        [ 0.0007, -0.0161,  0.0026,  ...,  0.0043,  0.0079,  0.0049],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0', dtype=torch.float16)
1 tensor([[ 0.0012,  0.0057, -0.0033,  ...,  0.0041, -0.0026, -0.0007],
        [-0.0034,  0.0013, -0.0017,  ...,  0.0009, -0.0019, -0.0022],
        [ 0.0007, -0.0161,  0.0026,  ...,  0.0043,  0.0079,  0.0049],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0', dtype=torch.float16)
2 0
Error in completion_gradient: 'int' object has no attribute 'norm'
Error calculating gradient for sample 2 (dataset index 41): 'int' object has no attribute 'norm'
Processing sample 3/5 (dataset index: 400)
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
0 tensor([[ 0.0012,  0.0057, -0.0033,  ...,  0.0041, -0.0026, -0.0007],
        [-0.0034,  0.0013, -0.0017,  ...,  0.0009, -0.0019, -0.0022],
        [ 0.0007, -0.0161,  0.0026,  ...,  0.0043,  0.0079,  0.0049],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0', dtype=torch.float16)
1 tensor([[ 0.0012,  0.0057, -0.0033,  ...,  0.0041, -0.0026, -0.0007],
        [-0.0034,  0.0013, -0.0017,  ...,  0.0009, -0.0019, -0.0022],
        [ 0.0007, -0.0161,  0.0026,  ...,  0.0043,  0.0079,  0.0049],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0', dtype=torch.float16)
2 0
Error in completion_gradient: 'int' object has no attribute 'norm'
Error calculating gradient for sample 3 (dataset index 400): 'int' object has no attribute 'norm'
Processing sample 4/5 (dataset index: 813)
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
0 tensor([[ 0.0012,  0.0057, -0.0033,  ...,  0.0041, -0.0026, -0.0007],
        [-0.0034,  0.0013, -0.0017,  ...,  0.0009, -0.0019, -0.0022],
        [ 0.0007, -0.0161,  0.0026,  ...,  0.0043,  0.0079,  0.0049],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0', dtype=torch.float16)
1 tensor([[ 0.0012,  0.0057, -0.0033,  ...,  0.0041, -0.0026, -0.0007],
        [-0.0034,  0.0013, -0.0017,  ...,  0.0009, -0.0019, -0.0022],
        [ 0.0007, -0.0161,  0.0026,  ...,  0.0043,  0.0079,  0.0049],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0', dtype=torch.float16)
2 0
Error in completion_gradient: 'int' object has no attribute 'norm'
Error calculating gradient for sample 4 (dataset index 813): 'int' object has no attribute 'norm'
Processing sample 5/5 (dataset index: 102)
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
0 tensor([[ 0.0012,  0.0057, -0.0033,  ...,  0.0041, -0.0026, -0.0007],
        [-0.0034,  0.0013, -0.0017,  ...,  0.0009, -0.0019, -0.0022],
        [ 0.0007, -0.0161,  0.0026,  ...,  0.0043,  0.0079,  0.0049],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0', dtype=torch.float16)
1 tensor([[ 0.0012,  0.0057, -0.0033,  ...,  0.0041, -0.0026, -0.0007],
        [-0.0034,  0.0013, -0.0017,  ...,  0.0009, -0.0019, -0.0022],
        [ 0.0007, -0.0161,  0.0026,  ...,  0.0043,  0.0079,  0.0049],
        ...,
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000]],
       device='cuda:0', dtype=torch.float16)
2 0
Error in completion_gradient: 'int' object has no attribute 'norm'
Error calculating gradient for sample 5 (dataset index 102): 'int' object has no attribute 'norm'
Processing complete, but no successful results to save. All 5 samples failed.
[main ebaea14] QA Script Results for Run 719191 (Commit: fa14fe8)
 2 files changed, 128 insertions(+)
 create mode 100644 slurm-outputs/slurm.719191.abakus11.out
To github.com:ngruenefeld/gradient-uncertainty.git
   fa14fe8..ebaea14  main -> main
