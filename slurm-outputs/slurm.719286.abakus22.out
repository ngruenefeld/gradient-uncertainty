slurmstepd-abakus22: error: Unable to create TMPDIR [/tmp/user/24470]: Permission denied
slurmstepd-abakus22: error: Setting TMPDIR to /tmp
Running job with commit: 26d08318385f8bfa316c0056c61c6ee36d3e4755
Running command: python -um scripts.bert "719286" --key_mode "keyfile" --sample_size "0" --test_sample_size "0" --counterfactual "constant" --dataset "ag-pubmed" --model "distilbert"
Job number: 719286
Key mode: keyfile
Sample size: 0
Normalize: False
Counterfactual: constant
Dataset: ag-pubmed
Model: distilbert
Using full train dataset with 120000 samples.
Using full test dataset with 17600 samples.
Loading model: distilbert-base-uncased
Using device: cuda
Map:   0%|          | 0/120000 [00:00<?, ? examples/s]Map:   2%|▎         | 3000/120000 [00:00<00:06, 18847.73 examples/s]Map:   5%|▌         | 6000/120000 [00:00<00:05, 19742.72 examples/s]Map:   8%|▊         | 10000/120000 [00:00<00:05, 20364.69 examples/s]Map:  11%|█         | 13000/120000 [00:00<00:06, 16437.38 examples/s]Map:  14%|█▍        | 17000/120000 [00:00<00:05, 18019.65 examples/s]Map:  16%|█▌        | 19000/120000 [00:01<00:05, 18302.50 examples/s]Map:  18%|█▊        | 21000/120000 [00:01<00:05, 18025.26 examples/s]Map:  20%|██        | 24000/120000 [00:01<00:05, 18666.97 examples/s]Map:  23%|██▎       | 28000/120000 [00:01<00:04, 19475.87 examples/s]Map:  26%|██▌       | 31000/120000 [00:01<00:04, 19745.59 examples/s]Map:  29%|██▉       | 35000/120000 [00:01<00:04, 20072.56 examples/s]Map:  32%|███▎      | 39000/120000 [00:02<00:03, 20381.35 examples/s]Map:  35%|███▌      | 42000/120000 [00:02<00:04, 16626.34 examples/s]Map:  38%|███▊      | 46000/120000 [00:02<00:04, 17897.37 examples/s]Map:  42%|████▏     | 50000/120000 [00:02<00:03, 18651.33 examples/s]Map:  45%|████▌     | 54000/120000 [00:02<00:03, 19317.19 examples/s]Map:  47%|████▋     | 56000/120000 [00:02<00:03, 19365.54 examples/s]Map:  50%|█████     | 60000/120000 [00:03<00:03, 19872.92 examples/s]Map:  52%|█████▎    | 63000/120000 [00:03<00:03, 17240.58 examples/s]Map:  56%|█████▌    | 67000/120000 [00:03<00:02, 18284.07 examples/s]Map:  58%|█████▊    | 70000/120000 [00:03<00:02, 18726.40 examples/s]Map:  61%|██████    | 73000/120000 [00:03<00:02, 19157.19 examples/s]Map:  62%|██████▎   | 75000/120000 [00:03<00:02, 19088.02 examples/s]Map:  65%|██████▌   | 78000/120000 [00:04<00:02, 19428.57 examples/s]Map:  68%|██████▊   | 81000/120000 [00:04<00:02, 17331.02 examples/s]Map:  70%|███████   | 84000/120000 [00:04<00:01, 18193.71 examples/s]Map:  72%|███████▏  | 86000/120000 [00:04<00:02, 15889.65 examples/s]Map:  73%|███████▎  | 88000/120000 [00:04<00:01, 16723.77 examples/s]Map:  76%|███████▌  | 91000/120000 [00:04<00:01, 17769.58 examples/s]Map:  79%|███████▉  | 95000/120000 [00:05<00:01, 18849.92 examples/s]Map:  82%|████████▎ | 99000/120000 [00:05<00:01, 19475.76 examples/s]Map:  85%|████████▌ | 102000/120000 [00:05<00:00, 19653.51 examples/s]Map:  88%|████████▊ | 106000/120000 [00:05<00:00, 20027.74 examples/s]Map:  92%|█████████▏| 110000/120000 [00:05<00:00, 17719.21 examples/s]Map:  95%|█████████▌| 114000/120000 [00:06<00:00, 18636.92 examples/s]Map:  98%|█████████▊| 118000/120000 [00:06<00:00, 19313.67 examples/s]Map: 100%|██████████| 120000/120000 [00:06<00:00, 18683.57 examples/s]
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/scripts/bert.py:215: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Calculating uncertainties for 17600 test samples before training (counterfactual mode: constant)...
Processing test sample 1/17600 (before training)
Processing test sample 2/17600 (before training)
Processing test sample 3/17600 (before training)
Processing test sample 4/17600 (before training)
Processing test sample 5/17600 (before training)
Processing test sample 6/17600 (before training)
Processing test sample 7/17600 (before training)
Processing test sample 8/17600 (before training)
Processing test sample 9/17600 (before training)
Processing test sample 10/17600 (before training)
Processing test sample 11/17600 (before training)
Processing test sample 12/17600 (before training)
Processing test sample 13/17600 (before training)
Processing test sample 14/17600 (before training)
Processing test sample 15/17600 (before training)
Processing test sample 16/17600 (before training)
Processing test sample 17/17600 (before training)
Processing test sample 18/17600 (before training)
Processing test sample 19/17600 (before training)
Processing test sample 20/17600 (before training)
Processing test sample 21/17600 (before training)
Processing test sample 22/17600 (before training)
Processing test sample 23/17600 (before training)
Processing test sample 24/17600 (before training)
Processing test sample 25/17600 (before training)
Processing test sample 26/17600 (before training)
Processing test sample 27/17600 (before training)
Processing test sample 28/17600 (before training)
Processing test sample 29/17600 (before training)
Processing test sample 30/17600 (before training)
Processing test sample 31/17600 (before training)
Processing test sample 32/17600 (before training)
Processing test sample 33/17600 (before training)
Processing test sample 34/17600 (before training)
Processing test sample 35/17600 (before training)
Processing test sample 36/17600 (before training)
Processing test sample 37/17600 (before training)
Processing test sample 38/17600 (before training)
Processing test sample 39/17600 (before training)
Processing test sample 40/17600 (before training)
Processing test sample 41/17600 (before training)
Processing test sample 42/17600 (before training)
Processing test sample 43/17600 (before training)
Processing test sample 44/17600 (before training)
Processing test sample 45/17600 (before training)
Processing test sample 46/17600 (before training)
Processing test sample 47/17600 (before training)
Processing test sample 48/17600 (before training)
Processing test sample 49/17600 (before training)
Processing test sample 50/17600 (before training)
Processing test sample 51/17600 (before training)
Processing test sample 52/17600 (before training)
Processing test sample 53/17600 (before training)
Processing test sample 54/17600 (before training)
Processing test sample 55/17600 (before training)
Processing test sample 56/17600 (before training)
Processing test sample 57/17600 (before training)
Processing test sample 58/17600 (before training)
Processing test sample 59/17600 (before training)
Processing test sample 60/17600 (before training)
Processing test sample 61/17600 (before training)
Processing test sample 62/17600 (before training)
Processing test sample 63/17600 (before training)
Processing test sample 64/17600 (before training)
Processing test sample 65/17600 (before training)
Processing test sample 66/17600 (before training)
Processing test sample 67/17600 (before training)
Processing test sample 68/17600 (before training)
Processing test sample 69/17600 (before training)
Processing test sample 70/17600 (before training)
Processing test sample 71/17600 (before training)
Processing test sample 72/17600 (before training)
Processing test sample 73/17600 (before training)
Processing test sample 74/17600 (before training)
Processing test sample 75/17600 (before training)
Processing test sample 76/17600 (before training)
Processing test sample 77/17600 (before training)
Processing test sample 78/17600 (before training)
Processing test sample 79/17600 (before training)
Processing test sample 80/17600 (before training)
Processing test sample 81/17600 (before training)
Processing test sample 82/17600 (before training)
Processing test sample 83/17600 (before training)
Processing test sample 84/17600 (before training)
Processing test sample 85/17600 (before training)
Processing test sample 86/17600 (before training)
Processing test sample 87/17600 (before training)
Processing test sample 88/17600 (before training)
Processing test sample 89/17600 (before training)
Processing test sample 90/17600 (before training)
Processing test sample 91/17600 (before training)
Processing test sample 92/17600 (before training)
Processing test sample 93/17600 (before training)
Processing test sample 94/17600 (before training)
Processing test sample 95/17600 (before training)
Processing test sample 96/17600 (before training)
Processing test sample 97/17600 (before training)
Processing test sample 98/17600 (before training)
Processing test sample 99/17600 (before training)
Processing test sample 100/17600 (before training)
Processing test sample 101/17600 (before training)
Processing test sample 102/17600 (before training)
Processing test sample 103/17600 (before training)
Processing test sample 104/17600 (before training)
Processing test sample 105/17600 (before training)
Processing test sample 106/17600 (before training)
Processing test sample 107/17600 (before training)
Processing test sample 108/17600 (before training)
Processing test sample 109/17600 (before training)
Processing test sample 110/17600 (before training)
Processing test sample 111/17600 (before training)
Processing test sample 112/17600 (before training)
Processing test sample 113/17600 (before training)
Processing test sample 114/17600 (before training)
Processing test sample 115/17600 (before training)
Processing test sample 116/17600 (before training)
Processing test sample 117/17600 (before training)
Processing test sample 118/17600 (before training)
Processing test sample 119/17600 (before training)
Processing test sample 120/17600 (before training)
Processing test sample 121/17600 (before training)
Processing test sample 122/17600 (before training)
Processing test sample 123/17600 (before training)
Processing test sample 124/17600 (before training)
Processing test sample 125/17600 (before training)
Processing test sample 126/17600 (before training)
Processing test sample 127/17600 (before training)
Processing test sample 128/17600 (before training)
Processing test sample 129/17600 (before training)
Processing test sample 130/17600 (before training)
Processing test sample 131/17600 (before training)
Processing test sample 132/17600 (before training)
Processing test sample 133/17600 (before training)
Processing test sample 134/17600 (before training)
Processing test sample 135/17600 (before training)
Processing test sample 136/17600 (before training)
Processing test sample 137/17600 (before training)
Processing test sample 138/17600 (before training)
Processing test sample 139/17600 (before training)
Processing test sample 140/17600 (before training)
Processing test sample 141/17600 (before training)
Processing test sample 142/17600 (before training)
