slurmstepd-abakus11: error: Unable to create TMPDIR [/tmp/user/24470]: Permission denied
slurmstepd-abakus11: error: Setting TMPDIR to /tmp
Running job with commit: 8cc63aacd369f37d1039263f75d8481628596c2e
[nltk_data] Downloading package stopwords to
[nltk_data]     /home/g/gruenefeld/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package wordnet to
[nltk_data]     /home/g/gruenefeld/nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
Job number: 60018
Dataset: ag-pubmed
Model: llama-3-8b
GPT Model: gpt-4o-mini-2024-07-18
Key mode: keyfile
Mode: test
Quantization bits: 4
Full gradient: False
Response only: True
Normalize: False
Perturbation mode: random
Number of perturbations: 3
Max tokens: 0
Sample Size Per Label: 5
Loading model in 4-bit precision to reduce memory usage
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:06,  2.28s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:04<00:04,  2.28s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:06<00:02,  2.25s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.60s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:07<00:00,  1.84s/it]
Processing sample 1/25 (dataset index: 0)
Processing sample 1 (dataset index 0)
tensor([[[ 4.9023,  6.4648,  9.9297,  ..., -3.2441, -3.2441, -3.2441],
         [ 6.8945,  5.6484,  6.8984,  ..., -2.0918, -2.0918, -2.0918],
         [ 6.8477,  2.8457,  2.1914,  ..., -6.9688, -6.9688, -6.9688],
         ...,
         [ 7.2461,  9.3438,  4.6484,  ..., -2.6562, -2.6562, -2.6562],
         [ 6.9766,  9.1875,  2.4668,  ..., -2.5762, -2.5762, -2.5762],
         [-0.2357,  1.1357,  0.1154,  ..., -4.6367, -4.6367, -4.6367]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4648,  9.9297,  ..., -3.2441, -3.2441, -3.2441],
        [ 6.8945,  5.6484,  6.8984,  ..., -2.0918, -2.0918, -2.0918],
        [ 6.8477,  2.8457,  2.1914,  ..., -6.9688, -6.9688, -6.9688],
        ...,
        [ 7.2461,  9.3438,  4.6484,  ..., -2.6562, -2.6562, -2.6562],
        [ 6.9766,  9.1875,  2.4668,  ..., -2.5762, -2.5762, -2.5762],
        [-0.2357,  1.1357,  0.1154,  ..., -4.6367, -4.6367, -4.6367]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1992,  -3.7344,  ..., -16.9062, -16.9062, -16.9062],
        [-11.0938, -12.3438, -11.0938,  ..., -20.0781, -20.0781, -20.0781],
        [ -8.1328, -12.1328, -12.7891,  ..., -21.9531, -21.9531, -21.9531],
        ...,
        [-13.2969, -11.1953, -15.8906,  ..., -23.2031, -23.2031, -23.2031],
        [-13.4688, -11.2578, -17.9844,  ..., -23.0312, -23.0312, -23.0312],
        [-17.6875, -16.3125, -17.3281,  ..., -22.0781, -22.0781, -22.0781]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 1 (dataset index 0): name 'probs' is not defined
Processing sample 2/25 (dataset index: 1)
Processing sample 2 (dataset index 1)
tensor([[[ 4.8945,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
         [ 7.4922,  3.5293,  2.3242,  ..., -5.1094, -5.1094, -5.1094],
         [ 7.5234,  5.8945,  7.3867,  ..., -4.5625, -4.5625, -4.5625],
         ...,
         [ 9.8516,  9.7969,  6.5781,  ..., -6.7656, -6.7656, -6.7656],
         [ 6.8086,  9.2109,  4.1680,  ..., -3.0605, -3.0605, -3.0605],
         [ 0.6230,  0.9980,  4.9844,  ..., -5.6523, -5.6523, -5.6523]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8945,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
        [ 7.4922,  3.5293,  2.3242,  ..., -5.1094, -5.1094, -5.1094],
        [ 7.5234,  5.8945,  7.3867,  ..., -4.5625, -4.5625, -4.5625],
        ...,
        [ 9.8516,  9.7969,  6.5781,  ..., -6.7656, -6.7656, -6.7656],
        [ 6.8086,  9.2109,  4.1680,  ..., -3.0605, -3.0605, -3.0605],
        [ 0.6230,  0.9980,  4.9844,  ..., -5.6523, -5.6523, -5.6523]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2031,  -3.7363,  ..., -16.8906, -16.8906, -16.8906],
        [ -8.3750, -12.3438, -13.5469,  ..., -20.9844, -20.9844, -20.9844],
        [-12.1953, -13.8203, -12.3281,  ..., -24.2812, -24.2812, -24.2812],
        ...,
        [-14.6484, -14.7031, -17.9219,  ..., -31.2656, -31.2656, -31.2656],
        [-13.9297, -11.5312, -16.5781,  ..., -23.7969, -23.7969, -23.7969],
        [-16.4062, -16.0312, -12.0547,  ..., -22.6875, -22.6875, -22.6875]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 2 (dataset index 1): name 'probs' is not defined
Processing sample 3/25 (dataset index: 2)
Processing sample 3 (dataset index 2)
tensor([[[ 4.8945,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
         [ 5.6641,  4.9336,  6.2344,  ..., -5.2422, -5.2422, -5.2422],
         [ 6.5039,  3.0684,  2.0918,  ..., -5.5586, -5.5586, -5.5586],
         ...,
         [ 4.7539,  6.6289,  2.4961,  ..., -3.8770, -3.8789, -3.8789],
         [ 5.3594,  6.9961,  1.6611,  ..., -3.3848, -3.3848, -3.3848],
         [ 4.6406,  2.9375,  6.0742,  ..., -7.9883, -7.9883, -7.9883]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8945,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
        [ 5.6641,  4.9336,  6.2344,  ..., -5.2422, -5.2422, -5.2422],
        [ 6.5039,  3.0684,  2.0918,  ..., -5.5586, -5.5586, -5.5586],
        ...,
        [ 4.7539,  6.6289,  2.4961,  ..., -3.8770, -3.8789, -3.8789],
        [ 5.3594,  6.9961,  1.6611,  ..., -3.3848, -3.3848, -3.3848],
        [ 4.6406,  2.9375,  6.0742,  ..., -7.9883, -7.9883, -7.9883]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2031,  -3.7363,  ..., -16.8906, -16.8906, -16.8906],
        [-12.6328, -13.3672, -12.0625,  ..., -23.5469, -23.5469, -23.5469],
        [-12.5938, -16.0312, -17.0000,  ..., -24.6562, -24.6562, -24.6562],
        ...,
        [-16.6406, -14.7656, -18.8906,  ..., -25.2656, -25.2656, -25.2656],
        [-12.5156, -10.8750, -16.2031,  ..., -21.2500, -21.2500, -21.2500],
        [-10.5625, -12.2656,  -9.1328,  ..., -23.1875, -23.1875, -23.1875]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 3 (dataset index 2): name 'probs' is not defined
Processing sample 4/25 (dataset index: 3)
Processing sample 4 (dataset index 3)
tensor([[[ 4.9023,  6.4688,  9.9375,  ..., -3.2461, -3.2461, -3.2461],
         [ 6.4336,  4.7070,  4.5391,  ..., -4.6133, -4.6133, -4.6133],
         [ 3.8984,  1.6514,  0.9507,  ..., -8.6719, -8.6719, -8.6719],
         ...,
         [ 2.8789,  4.2891, -1.1377,  ..., -5.1953, -5.1953, -5.1953],
         [ 8.9688, 10.0625,  3.5273,  ..., -3.9707, -3.9707, -3.9707],
         [ 5.7578,  6.7930,  5.9883,  ..., -7.7539, -7.7539, -7.7539]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4688,  9.9375,  ..., -3.2461, -3.2461, -3.2461],
        [ 6.4336,  4.7070,  4.5391,  ..., -4.6133, -4.6133, -4.6133],
        [ 3.8984,  1.6514,  0.9507,  ..., -8.6719, -8.6719, -8.6719],
        ...,
        [ 2.8789,  4.2891, -1.1377,  ..., -5.1953, -5.1953, -5.1953],
        [ 8.9688, 10.0625,  3.5273,  ..., -3.9707, -3.9707, -3.9707],
        [ 5.7578,  6.7930,  5.9883,  ..., -7.7539, -7.7539, -7.7539]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1953,  -3.7285,  ..., -16.9062, -16.9062, -16.9062],
        [-11.1094, -12.8359, -13.0078,  ..., -22.1562, -22.1562, -22.1562],
        [ -9.7500, -12.0000, -12.7031,  ..., -22.3281, -22.3281, -22.3281],
        ...,
        [-15.6406, -14.2266, -19.6562,  ..., -23.7188, -23.7188, -23.7188],
        [-12.1875, -11.0938, -17.6250,  ..., -25.1250, -25.1250, -25.1250],
        [ -9.3359,  -8.3047,  -9.1094,  ..., -22.8438, -22.8438, -22.8438]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 4 (dataset index 3): name 'probs' is not defined
Processing sample 5/25 (dataset index: 4)
Processing sample 5 (dataset index 4)
tensor([[[ 4.9023,  6.4688,  9.9297,  ..., -3.2461, -3.2461, -3.2461],
         [ 5.9219,  4.3242,  5.6953,  ..., -3.6660, -3.6660, -3.6660],
         [ 6.2773,  3.7305,  2.6816,  ..., -5.7930, -5.7930, -5.7930],
         ...,
         [ 5.8086,  5.6133,  3.6035,  ..., -5.4961, -5.4961, -5.4961],
         [ 6.4648,  6.5078,  4.9648,  ..., -4.0469, -4.0469, -4.0469],
         [-1.1309, -0.6909, -0.3674,  ..., -4.1172, -4.1172, -4.1172]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4688,  9.9297,  ..., -3.2461, -3.2461, -3.2461],
        [ 5.9219,  4.3242,  5.6953,  ..., -3.6660, -3.6660, -3.6660],
        [ 6.2773,  3.7305,  2.6816,  ..., -5.7930, -5.7930, -5.7930],
        ...,
        [ 5.8086,  5.6133,  3.6035,  ..., -5.4961, -5.4961, -5.4961],
        [ 6.4648,  6.5078,  4.9648,  ..., -4.0469, -4.0469, -4.0469],
        [-1.1309, -0.6909, -0.3674,  ..., -4.1172, -4.1172, -4.1172]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1953,  -3.7363,  ..., -16.9062, -16.9062, -16.9062],
        [-11.2031, -12.8047, -11.4297,  ..., -20.7969, -20.7969, -20.7969],
        [-14.6562, -17.2031, -18.2500,  ..., -26.7188, -26.7188, -26.7188],
        ...,
        [-16.8594, -17.0469, -19.0625,  ..., -28.1562, -28.1562, -28.1562],
        [-13.8594, -13.8203, -15.3594,  ..., -24.3750, -24.3750, -24.3750],
        [-18.6719, -18.2188, -17.9062,  ..., -21.6562, -21.6562, -21.6562]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 5 (dataset index 4): name 'probs' is not defined
Processing sample 6/25 (dataset index: 5)
Processing sample 6 (dataset index 5)
tensor([[[ 4.8867,  6.4453,  9.9062,  ..., -3.2324, -3.2324, -3.2324],
         [ 5.6758,  4.2930,  5.8047,  ..., -3.6934, -3.6934, -3.6934],
         [ 7.3711,  2.8262,  0.8423,  ..., -8.7031, -8.7031, -8.7031],
         ...,
         [10.5938,  8.5000,  6.4414,  ..., -2.0312, -2.0312, -2.0312],
         [11.2578,  7.2656,  5.5078,  ..., -2.9492, -2.9473, -2.9473],
         [ 1.6328,  2.4629,  1.5059,  ..., -3.9727, -3.9727, -3.9727]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8867,  6.4453,  9.9062,  ..., -3.2324, -3.2324, -3.2324],
        [ 5.6758,  4.2930,  5.8047,  ..., -3.6934, -3.6934, -3.6934],
        [ 7.3711,  2.8262,  0.8423,  ..., -8.7031, -8.7031, -8.7031],
        ...,
        [10.5938,  8.5000,  6.4414,  ..., -2.0312, -2.0312, -2.0312],
        [11.2578,  7.2656,  5.5078,  ..., -2.9492, -2.9473, -2.9473],
        [ 1.6328,  2.4629,  1.5059,  ..., -3.9727, -3.9727, -3.9727]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2109,  -3.7480,  ..., -16.8906, -16.8906, -16.8906],
        [-11.3984, -12.7812, -11.2656,  ..., -20.7656, -20.7656, -20.7656],
        [ -6.1016, -10.6484, -12.6328,  ..., -22.1719, -22.1719, -22.1719],
        ...,
        [-13.2422, -15.3359, -17.3906,  ..., -25.8594, -25.8594, -25.8594],
        [ -8.6250, -12.6172, -14.3750,  ..., -22.8281, -22.8281, -22.8281],
        [-16.0000, -15.1797, -16.1406,  ..., -21.6094, -21.6094, -21.6094]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 6 (dataset index 5): name 'probs' is not defined
Processing sample 7/25 (dataset index: 6)
Processing sample 7 (dataset index 6)
tensor([[[  4.9023,   6.4688,   9.9375,  ...,  -3.2461,  -3.2461,  -3.2461],
         [  5.0078,   5.1367,   5.3594,  ...,  -3.2773,  -3.2773,  -3.2773],
         [  7.5352,   2.9629,   0.6890,  ...,  -6.9492,  -6.9492,  -6.9492],
         ...,
         [  7.3125,   9.3672,   4.3203,  ...,  -3.6504,  -3.6504,  -3.6504],
         [  5.9531,   7.6641,   3.0859,  ...,  -5.4648,  -5.4648,  -5.4648],
         [  2.6777,   4.2773,   3.3613,  ..., -10.0781, -10.0781, -10.0781]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[  4.9023,   6.4688,   9.9375,  ...,  -3.2461,  -3.2461,  -3.2461],
        [  5.0078,   5.1367,   5.3594,  ...,  -3.2773,  -3.2773,  -3.2773],
        [  7.5352,   2.9629,   0.6890,  ...,  -6.9492,  -6.9492,  -6.9492],
        ...,
        [  7.3125,   9.3672,   4.3203,  ...,  -3.6504,  -3.6504,  -3.6504],
        [  5.9531,   7.6641,   3.0859,  ...,  -5.4648,  -5.4648,  -5.4648],
        [  2.6777,   4.2773,   3.3613,  ..., -10.0781, -10.0781, -10.0781]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1953,  -3.7285,  ..., -16.9062, -16.9062, -16.9062],
        [-12.1250, -11.9922, -11.7734,  ..., -20.4062, -20.4062, -20.4062],
        [ -6.9688, -11.5391, -13.8125,  ..., -21.4531, -21.4531, -21.4531],
        ...,
        [-14.6641, -12.6094, -17.6562,  ..., -25.6250, -25.6250, -25.6250],
        [-14.1250, -12.4141, -16.9844,  ..., -25.5469, -25.5469, -25.5469],
        [-11.7031, -10.1016, -11.0156,  ..., -24.4531, -24.4531, -24.4531]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 7 (dataset index 6): name 'probs' is not defined
Processing sample 8/25 (dataset index: 7)
Processing sample 8 (dataset index 7)
tensor([[[ 4.9023,  6.4688,  9.9375,  ..., -3.2461, -3.2461, -3.2461],
         [ 9.3281,  4.5781,  6.7266,  ..., -3.5176, -3.5176, -3.5176],
         [ 6.0352,  4.1953,  2.1113,  ..., -5.7734, -5.7734, -5.7734],
         ...,
         [ 3.2637,  6.6680,  0.4534,  ..., -4.9922, -4.9922, -4.9922],
         [ 6.0039,  7.3203,  1.2803,  ..., -3.4180, -3.4180, -3.4180],
         [ 3.2168,  8.3047,  3.7812,  ..., -6.9258, -6.9258, -6.9258]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4688,  9.9375,  ..., -3.2461, -3.2461, -3.2461],
        [ 9.3281,  4.5781,  6.7266,  ..., -3.5176, -3.5176, -3.5176],
        [ 6.0352,  4.1953,  2.1113,  ..., -5.7734, -5.7734, -5.7734],
        ...,
        [ 3.2637,  6.6680,  0.4534,  ..., -4.9922, -4.9922, -4.9922],
        [ 6.0039,  7.3203,  1.2803,  ..., -3.4180, -3.4180, -3.4180],
        [ 3.2168,  8.3047,  3.7812,  ..., -6.9258, -6.9258, -6.9258]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1953,  -3.7285,  ..., -16.9062, -16.9062, -16.9062],
        [ -9.7344, -14.4844, -12.3359,  ..., -22.5781, -22.5781, -22.5781],
        [ -9.3750, -11.2188, -13.2969,  ..., -21.1875, -21.1875, -21.1875],
        ...,
        [-17.6250, -14.2188, -20.4375,  ..., -25.8750, -25.8750, -25.8750],
        [-15.5078, -14.1875, -20.2344,  ..., -24.9219, -24.9219, -24.9219],
        [-13.9219,  -8.8359, -13.3594,  ..., -24.0625, -24.0625, -24.0625]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 8 (dataset index 7): name 'probs' is not defined
Processing sample 9/25 (dataset index: 8)
Processing sample 9 (dataset index 8)
tensor([[[ 4.9023,  6.4688,  9.9375,  ..., -3.2461, -3.2461, -3.2461],
         [ 7.0430,  5.1484,  6.2188,  ..., -2.8926, -2.8926, -2.8926],
         [ 2.9668, -0.0960, -1.0410,  ..., -7.8711, -7.8711, -7.8711],
         ...,
         [ 4.4414,  3.7793, -0.6895,  ..., -5.4258, -5.4258, -5.4258],
         [ 5.0156,  5.9453,  2.5801,  ..., -6.1523, -6.1523, -6.1523],
         [ 3.7969,  5.0039,  4.6367,  ..., -9.8828, -9.8828, -9.8828]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4688,  9.9375,  ..., -3.2461, -3.2461, -3.2461],
        [ 7.0430,  5.1484,  6.2188,  ..., -2.8926, -2.8926, -2.8926],
        [ 2.9668, -0.0960, -1.0410,  ..., -7.8711, -7.8711, -7.8711],
        ...,
        [ 4.4414,  3.7793, -0.6895,  ..., -5.4258, -5.4258, -5.4258],
        [ 5.0156,  5.9453,  2.5801,  ..., -6.1523, -6.1523, -6.1523],
        [ 3.7969,  5.0039,  4.6367,  ..., -9.8828, -9.8828, -9.8828]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1953,  -3.7285,  ..., -16.9062, -16.9062, -16.9062],
        [-10.6797, -12.5781, -11.5078,  ..., -20.6250, -20.6250, -20.6250],
        [-10.4531, -13.5156, -14.4609,  ..., -21.2812, -21.2812, -21.2812],
        ...,
        [-13.4922, -14.1562, -18.6250,  ..., -23.3594, -23.3594, -23.3594],
        [-14.9609, -14.0312, -17.4062,  ..., -26.1250, -26.1250, -26.1250],
        [-10.7500,  -9.5469,  -9.9141,  ..., -24.4375, -24.4375, -24.4375]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 9 (dataset index 8): name 'probs' is not defined
Processing sample 10/25 (dataset index: 9)
Processing sample 10 (dataset index 9)
tensor([[[ 4.8867,  6.4453,  9.9062,  ..., -3.2305, -3.2305, -3.2324],
         [ 3.2676,  3.8535,  0.4080,  ..., -9.1328, -9.1328, -9.1328],
         [ 3.6523,  3.4062, -0.5200,  ..., -9.6562, -9.6562, -9.6562],
         ...,
         [ 7.4492,  4.8438,  1.3896,  ..., -5.2656, -5.2656, -5.2656],
         [ 9.6484,  6.1602,  2.9414,  ..., -4.9844, -4.9844, -4.9844],
         [-0.7031, -0.4556, -1.3848,  ..., -7.5117, -7.5117, -7.5117]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8867,  6.4453,  9.9062,  ..., -3.2305, -3.2305, -3.2324],
        [ 3.2676,  3.8535,  0.4080,  ..., -9.1328, -9.1328, -9.1328],
        [ 3.6523,  3.4062, -0.5200,  ..., -9.6562, -9.6562, -9.6562],
        ...,
        [ 7.4492,  4.8438,  1.3896,  ..., -5.2656, -5.2656, -5.2656],
        [ 9.6484,  6.1602,  2.9414,  ..., -4.9844, -4.9844, -4.9844],
        [-0.7031, -0.4556, -1.3848,  ..., -7.5117, -7.5117, -7.5117]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2109,  -3.7480,  ..., -16.8906, -16.8906, -16.8906],
        [-11.4922, -10.9062, -14.3516,  ..., -23.8906, -23.8906, -23.8906],
        [-12.5469, -12.7969, -16.7188,  ..., -25.8594, -25.8594, -25.8594],
        ...,
        [-12.4219, -15.0234, -18.4844,  ..., -25.1406, -25.1406, -25.1406],
        [-10.1406, -13.6328, -16.8438,  ..., -24.7812, -24.7812, -24.7812],
        [-16.2656, -16.0156, -16.9375,  ..., -23.0625, -23.0625, -23.0625]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 10 (dataset index 9): name 'probs' is not defined
Processing sample 11/25 (dataset index: 10)
Processing sample 11 (dataset index 10)
tensor([[[ 4.8984,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
         [ 6.3438,  5.1523,  8.9062,  ..., -3.3750, -3.3750, -3.3750],
         [ 4.3984,  1.3369, -1.1250,  ..., -8.3672, -8.3672, -8.3672],
         ...,
         [ 7.0391,  4.8672,  3.7988,  ..., -6.9258, -6.9258, -6.9219],
         [ 6.2344,  5.7578,  5.8398,  ..., -4.2148, -4.2148, -4.2148],
         [ 0.2817, -0.3872,  2.4316,  ..., -3.7324, -3.7324, -3.7324]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8984,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
        [ 6.3438,  5.1523,  8.9062,  ..., -3.3750, -3.3750, -3.3750],
        [ 4.3984,  1.3369, -1.1250,  ..., -8.3672, -8.3672, -8.3672],
        ...,
        [ 7.0391,  4.8672,  3.7988,  ..., -6.9258, -6.9258, -6.9219],
        [ 6.2344,  5.7578,  5.8398,  ..., -4.2148, -4.2148, -4.2148],
        [ 0.2817, -0.3872,  2.4316,  ..., -3.7324, -3.7324, -3.7324]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7578,  -7.2031,  -3.7363,  ..., -16.8906, -16.8906, -16.8906],
        [-11.2422, -12.4375,  -8.6797,  ..., -20.9688, -20.9688, -20.9688],
        [ -9.4531, -12.5156, -14.9766,  ..., -22.2188, -22.2188, -22.2188],
        ...,
        [-15.3281, -17.5000, -18.5625,  ..., -29.2969, -29.2969, -29.2812],
        [-11.9297, -12.4062, -12.3281,  ..., -22.3750, -22.3750, -22.3750],
        [-17.1562, -17.8125, -15.0000,  ..., -21.1719, -21.1719, -21.1719]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 11 (dataset index 10): name 'probs' is not defined
Processing sample 12/25 (dataset index: 11)
Processing sample 12 (dataset index 11)
tensor([[[ 4.9023,  6.4648,  9.9297,  ..., -3.2422, -3.2422, -3.2422],
         [ 5.0039,  1.4834,  2.8340,  ..., -6.8984, -6.8984, -6.8984],
         [ 8.3125,  4.9219,  3.4902,  ..., -7.5039, -7.5039, -7.5039],
         ...,
         [ 3.5781,  6.0938,  4.7227,  ..., -5.5234, -5.5234, -5.5234],
         [ 7.9180,  9.0156,  1.9863,  ..., -2.6992, -2.6992, -2.6973],
         [ 0.4243,  1.6387,  0.9795,  ..., -3.9062, -3.9062, -3.9062]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4648,  9.9297,  ..., -3.2422, -3.2422, -3.2422],
        [ 5.0039,  1.4834,  2.8340,  ..., -6.8984, -6.8984, -6.8984],
        [ 8.3125,  4.9219,  3.4902,  ..., -7.5039, -7.5039, -7.5039],
        ...,
        [ 3.5781,  6.0938,  4.7227,  ..., -5.5234, -5.5234, -5.5234],
        [ 7.9180,  9.0156,  1.9863,  ..., -2.6992, -2.6992, -2.6973],
        [ 0.4243,  1.6387,  0.9795,  ..., -3.9062, -3.9062, -3.9062]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1992,  -3.7344,  ..., -16.9062, -16.9062, -16.9062],
        [-10.1406, -13.6641, -12.3125,  ..., -22.0469, -22.0469, -22.0469],
        [ -7.7227, -11.1094, -12.5469,  ..., -23.5312, -23.5312, -23.5312],
        ...,
        [-16.9062, -14.3828, -15.7578,  ..., -26.0000, -26.0000, -26.0000],
        [-12.8047, -11.7109, -18.7344,  ..., -23.4219, -23.4219, -23.4219],
        [-16.3750, -15.1562, -15.8203,  ..., -20.7031, -20.7031, -20.7031]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 12 (dataset index 11): name 'probs' is not defined
Processing sample 13/25 (dataset index: 12)
Processing sample 13 (dataset index 12)
tensor([[[ 4.8945,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
         [ 6.0742,  4.9258,  5.9688,  ..., -3.8105, -3.8105, -3.8105],
         [ 4.1289,  2.6855,  2.2012,  ..., -6.9258, -6.9258, -6.9258],
         ...,
         [ 5.6133,  7.5078,  6.0547,  ..., -3.1387, -3.1387, -3.1387],
         [ 7.7148,  8.0703,  3.4219,  ..., -2.1875, -2.1875, -2.1875],
         [ 0.6362,  1.5361,  1.6982,  ..., -2.4199, -2.4199, -2.4199]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8945,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
        [ 6.0742,  4.9258,  5.9688,  ..., -3.8105, -3.8105, -3.8105],
        [ 4.1289,  2.6855,  2.2012,  ..., -6.9258, -6.9258, -6.9258],
        ...,
        [ 5.6133,  7.5078,  6.0547,  ..., -3.1387, -3.1387, -3.1387],
        [ 7.7148,  8.0703,  3.4219,  ..., -2.1875, -2.1875, -2.1875],
        [ 0.6362,  1.5361,  1.6982,  ..., -2.4199, -2.4199, -2.4199]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2031,  -3.7363,  ..., -16.8906, -16.8906, -16.8906],
        [-11.0000, -12.1484, -11.1016,  ..., -20.8906, -20.8906, -20.8906],
        [-10.8750, -12.3203, -12.8047,  ..., -21.9375, -21.9375, -21.9375],
        ...,
        [-18.4531, -16.5625, -18.0156,  ..., -27.2031, -27.2031, -27.2031],
        [-13.5078, -13.1562, -17.7969,  ..., -23.4062, -23.4062, -23.4062],
        [-17.2344, -16.3438, -16.1719,  ..., -20.2969, -20.2969, -20.2969]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 13 (dataset index 12): name 'probs' is not defined
Processing sample 14/25 (dataset index: 13)
Processing sample 14 (dataset index 13)
tensor([[[ 4.8867,  6.4453,  9.9062,  ..., -3.2324, -3.2324, -3.2324],
         [ 5.0117,  5.1445,  5.3555,  ..., -3.2812, -3.2812, -3.2812],
         [ 4.9414,  3.1387,  3.4609,  ..., -6.6211, -6.6211, -6.6211],
         ...,
         [ 4.5078,  6.3086, -0.4463,  ..., -4.0742, -4.0742, -4.0742],
         [ 6.3594,  6.9844,  0.2588,  ..., -2.9277, -2.9277, -2.9277],
         [-0.3804,  2.3184,  0.7495,  ..., -2.9648, -2.9648, -2.9648]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8867,  6.4453,  9.9062,  ..., -3.2324, -3.2324, -3.2324],
        [ 5.0117,  5.1445,  5.3555,  ..., -3.2812, -3.2812, -3.2812],
        [ 4.9414,  3.1387,  3.4609,  ..., -6.6211, -6.6211, -6.6211],
        ...,
        [ 4.5078,  6.3086, -0.4463,  ..., -4.0742, -4.0742, -4.0742],
        [ 6.3594,  6.9844,  0.2588,  ..., -2.9277, -2.9277, -2.9277],
        [-0.3804,  2.3184,  0.7495,  ..., -2.9648, -2.9648, -2.9648]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2109,  -3.7480,  ..., -16.8906, -16.8906, -16.8906],
        [-12.1172, -11.9844, -11.7734,  ..., -20.4062, -20.4062, -20.4062],
        [-13.2969, -15.0938, -14.7734,  ..., -24.8594, -24.8594, -24.8594],
        ...,
        [-15.8281, -14.0234, -20.7812,  ..., -24.4062, -24.4062, -24.4062],
        [-14.4766, -13.8516, -20.5781,  ..., -23.7656, -23.7656, -23.7656],
        [-18.7656, -16.0625, -17.6406,  ..., -21.3438, -21.3438, -21.3438]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 14 (dataset index 13): name 'probs' is not defined
Processing sample 15/25 (dataset index: 14)
Processing sample 15 (dataset index 14)
tensor([[[ 4.9023,  6.4648,  9.9297,  ..., -3.2441, -3.2441, -3.2441],
         [ 6.0781,  4.9297,  5.9766,  ..., -3.8125, -3.8125, -3.8125],
         [ 4.1289,  2.6875,  2.1992,  ..., -6.9258, -6.9258, -6.9258],
         ...,
         [ 2.8535,  5.4102,  0.7017,  ..., -2.1816, -2.1816, -2.1816],
         [ 6.2305,  5.7109,  1.7520,  ..., -1.8682, -1.8682, -1.8682],
         [-0.4429,  0.9795,  1.2148,  ..., -2.6738, -2.6738, -2.6738]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4648,  9.9297,  ..., -3.2441, -3.2441, -3.2441],
        [ 6.0781,  4.9297,  5.9766,  ..., -3.8125, -3.8125, -3.8125],
        [ 4.1289,  2.6875,  2.1992,  ..., -6.9258, -6.9258, -6.9258],
        ...,
        [ 2.8535,  5.4102,  0.7017,  ..., -2.1816, -2.1816, -2.1816],
        [ 6.2305,  5.7109,  1.7520,  ..., -1.8682, -1.8682, -1.8682],
        [-0.4429,  0.9795,  1.2148,  ..., -2.6738, -2.6738, -2.6738]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1992,  -3.7344,  ..., -16.9062, -16.9062, -16.9062],
        [-10.9922, -12.1406, -11.0938,  ..., -20.8906, -20.8906, -20.8906],
        [-10.8750, -12.3203, -12.8047,  ..., -21.9375, -21.9375, -21.9375],
        ...,
        [-18.9062, -16.3438, -21.0625,  ..., -23.9375, -23.9375, -23.9375],
        [-13.8203, -14.3359, -18.2969,  ..., -21.9219, -21.9219, -21.9219],
        [-18.2344, -16.8125, -16.5781,  ..., -20.4688, -20.4688, -20.4688]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 15 (dataset index 14): name 'probs' is not defined
Processing sample 16/25 (dataset index: 15)
Processing sample 16 (dataset index 15)
tensor([[[ 4.8945,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
         [-3.0293, -1.5547, -2.2734,  ..., -9.5781, -9.5781, -9.5781],
         [ 8.9766,  5.4609,  5.3086,  ..., -6.1523, -6.1523, -6.1523],
         ...,
         [ 6.5234,  9.0625,  5.8789,  ..., -5.3711, -5.3711, -5.3711],
         [ 9.6016,  7.1133,  4.4648,  ..., -4.0859, -4.0859, -4.0859],
         [-1.0469,  0.9072,  1.4766,  ..., -5.8984, -5.8984, -5.8984]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8945,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
        [-3.0293, -1.5547, -2.2734,  ..., -9.5781, -9.5781, -9.5781],
        [ 8.9766,  5.4609,  5.3086,  ..., -6.1523, -6.1523, -6.1523],
        ...,
        [ 6.5234,  9.0625,  5.8789,  ..., -5.3711, -5.3711, -5.3711],
        [ 9.6016,  7.1133,  4.4648,  ..., -4.0859, -4.0859, -4.0859],
        [-1.0469,  0.9072,  1.4766,  ..., -5.8984, -5.8984, -5.8984]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2031,  -3.7363,  ..., -16.8906, -16.8906, -16.8906],
        [-14.8984, -13.4219, -14.1406,  ..., -21.4375, -21.4375, -21.4375],
        [ -7.5391, -11.0547, -11.2031,  ..., -22.6719, -22.6719, -22.6719],
        ...,
        [-12.4922,  -9.9531, -13.1328,  ..., -24.3906, -24.3906, -24.3906],
        [ -8.9844, -11.4688, -14.1172,  ..., -22.6719, -22.6719, -22.6719],
        [-17.0312, -15.0859, -14.5156,  ..., -21.8906, -21.8906, -21.8906]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 16 (dataset index 15): name 'probs' is not defined
Processing sample 17/25 (dataset index: 16)
Processing sample 17 (dataset index 16)
tensor([[[ 4.8867,  6.4453,  9.9062,  ..., -3.2305, -3.2305, -3.2324],
         [ 6.2969,  4.0625,  1.7012,  ..., -5.2539, -5.2539, -5.2539],
         [ 0.4785, -3.8730, -2.4648,  ..., -6.6094, -6.6094, -6.6094],
         ...,
         [ 4.8398,  7.1602,  1.7129,  ..., -1.6719, -1.6719, -1.6719],
         [ 7.1094,  8.5078,  2.5039,  ..., -2.8457, -2.8457, -2.8457],
         [-0.2542,  0.5884, -0.6895,  ..., -5.1602, -5.1602, -5.1602]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8867,  6.4453,  9.9062,  ..., -3.2305, -3.2305, -3.2324],
        [ 6.2969,  4.0625,  1.7012,  ..., -5.2539, -5.2539, -5.2539],
        [ 0.4785, -3.8730, -2.4648,  ..., -6.6094, -6.6094, -6.6094],
        ...,
        [ 4.8398,  7.1602,  1.7129,  ..., -1.6719, -1.6719, -1.6719],
        [ 7.1094,  8.5078,  2.5039,  ..., -2.8457, -2.8457, -2.8457],
        [-0.2542,  0.5884, -0.6895,  ..., -5.1602, -5.1602, -5.1602]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2109,  -3.7480,  ..., -16.8906, -16.8906, -16.8906],
        [-10.1328, -12.3672, -14.7266,  ..., -21.6875, -21.6875, -21.6875],
        [-15.0781, -19.4375, -18.0312,  ..., -22.1719, -22.1719, -22.1719],
        ...,
        [-18.0781, -15.7500, -21.2031,  ..., -24.5781, -24.5781, -24.5781],
        [-13.2656, -11.8672, -17.8750,  ..., -23.2188, -23.2188, -23.2188],
        [-17.0781, -16.2344, -17.5156,  ..., -21.9844, -21.9844, -21.9844]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 17 (dataset index 16): name 'probs' is not defined
Processing sample 18/25 (dataset index: 17)
Processing sample 18 (dataset index 17)
tensor([[[ 4.8945,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
         [ 5.4141, -0.0123,  4.5156,  ..., -8.4141, -8.4141, -8.4141],
         [ 5.2031,  3.8965,  5.2148,  ..., -7.1758, -7.1758, -7.1758],
         ...,
         [ 5.3320,  5.7500,  0.2451,  ..., -5.2344, -5.2344, -5.2344],
         [ 7.4922,  6.1562,  0.3630,  ..., -7.5430, -7.5430, -7.5430],
         [ 2.0586,  4.6055, -0.2106,  ..., -3.5059, -3.5059, -3.5059]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8945,  6.4570,  9.9219,  ..., -3.2383, -3.2383, -3.2383],
        [ 5.4141, -0.0123,  4.5156,  ..., -8.4141, -8.4141, -8.4141],
        [ 5.2031,  3.8965,  5.2148,  ..., -7.1758, -7.1758, -7.1758],
        ...,
        [ 5.3320,  5.7500,  0.2451,  ..., -5.2344, -5.2344, -5.2344],
        [ 7.4922,  6.1562,  0.3630,  ..., -7.5430, -7.5430, -7.5430],
        [ 2.0586,  4.6055, -0.2106,  ..., -3.5059, -3.5059, -3.5059]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2031,  -3.7363,  ..., -16.8906, -16.8906, -16.8906],
        [ -9.1562, -14.5859, -10.0625,  ..., -22.9844, -22.9844, -22.9844],
        [ -9.9922, -11.2969,  -9.9766,  ..., -22.3750, -22.3750, -22.3750],
        ...,
        [-14.4766, -14.0547, -19.5625,  ..., -25.0469, -25.0469, -25.0469],
        [-12.0547, -13.3906, -19.1875,  ..., -27.0938, -27.0938, -27.0938],
        [-15.3047, -12.7578, -17.5781,  ..., -20.8750, -20.8750, -20.8750]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 18 (dataset index 17): name 'probs' is not defined
Processing sample 19/25 (dataset index: 18)
Processing sample 19 (dataset index 18)
tensor([[[ 4.8867,  6.4453,  9.9062,  ..., -3.2305, -3.2305, -3.2324],
         [ 3.9453,  3.0469,  3.3848,  ..., -5.0352, -5.0352, -5.0352],
         [ 3.9277,  1.6143,  2.8770,  ..., -6.1836, -6.1836, -6.1836],
         ...,
         [ 8.4219,  7.9922,  5.4141,  ..., -5.5195, -5.5195, -5.5195],
         [ 8.5859,  6.3828,  2.2949,  ..., -3.9062, -3.9062, -3.9062],
         [ 1.2812,  2.7031,  2.1523,  ..., -3.8828, -3.8828, -3.8828]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8867,  6.4453,  9.9062,  ..., -3.2305, -3.2305, -3.2324],
        [ 3.9453,  3.0469,  3.3848,  ..., -5.0352, -5.0352, -5.0352],
        [ 3.9277,  1.6143,  2.8770,  ..., -6.1836, -6.1836, -6.1836],
        ...,
        [ 8.4219,  7.9922,  5.4141,  ..., -5.5195, -5.5195, -5.5195],
        [ 8.5859,  6.3828,  2.2949,  ..., -3.9062, -3.9062, -3.9062],
        [ 1.2812,  2.7031,  2.1523,  ..., -3.8828, -3.8828, -3.8828]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2109,  -3.7480,  ..., -16.8906, -16.8906, -16.8906],
        [-12.3906, -13.2891, -12.9531,  ..., -21.3750, -21.3750, -21.3750],
        [-12.7656, -15.0859, -13.8203,  ..., -22.8750, -22.8750, -22.8750],
        ...,
        [-20.6406, -21.0781, -23.6562,  ..., -34.5938, -34.5938, -34.5938],
        [-10.7500, -12.9531, -17.0469,  ..., -23.2500, -23.2500, -23.2500],
        [-15.9219, -14.5000, -15.0469,  ..., -21.0781, -21.0781, -21.0781]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 19 (dataset index 18): name 'probs' is not defined
Processing sample 20/25 (dataset index: 19)
Processing sample 20 (dataset index 19)
tensor([[[ 4.8984,  6.4609,  9.9297,  ..., -3.2402, -3.2402, -3.2422],
         [ 5.9531,  2.3867,  1.5762,  ..., -6.0898, -6.0898, -6.0898],
         [ 8.0312,  5.6523,  7.1133,  ..., -7.8711, -7.8711, -7.8711],
         ...,
         [ 5.3164,  5.7500,  1.0166,  ..., -6.0977, -6.0977, -6.0977],
         [14.2109,  5.9648,  4.4727,  ..., -3.4199, -3.4199, -3.4199],
         [-0.8862, -2.2480,  2.2129,  ..., -4.5664, -4.5664, -4.5664]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8984,  6.4609,  9.9297,  ..., -3.2402, -3.2402, -3.2422],
        [ 5.9531,  2.3867,  1.5762,  ..., -6.0898, -6.0898, -6.0898],
        [ 8.0312,  5.6523,  7.1133,  ..., -7.8711, -7.8711, -7.8711],
        ...,
        [ 5.3164,  5.7500,  1.0166,  ..., -6.0977, -6.0977, -6.0977],
        [14.2109,  5.9648,  4.4727,  ..., -3.4199, -3.4199, -3.4199],
        [-0.8862, -2.2480,  2.2129,  ..., -4.5664, -4.5664, -4.5664]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2031,  -3.7324,  ..., -16.9062, -16.9062, -16.9062],
        [ -9.0000, -12.5625, -13.3750,  ..., -21.0469, -21.0469, -21.0469],
        [ -9.5469, -11.9219, -10.4609,  ..., -25.4531, -25.4531, -25.4531],
        ...,
        [-15.4219, -14.9844, -19.7188,  ..., -26.8281, -26.8281, -26.8281],
        [ -4.1133, -12.3594, -13.8516,  ..., -21.7500, -21.7500, -21.7500],
        [-17.4531, -18.8125, -14.3516,  ..., -21.1250, -21.1250, -21.1250]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 20 (dataset index 19): name 'probs' is not defined
Processing sample 21/25 (dataset index: 20)
Processing sample 21 (dataset index 20)
tensor([[[ 4.9023,  6.4688,  9.9375,  ..., -3.2461, -3.2461, -3.2461],
         [ 6.8750,  6.5391,  8.6172,  ..., -6.5469, -6.5469, -6.5469],
         [ 4.6992,  7.5781,  6.8672,  ..., -7.3164, -7.3164, -7.3164],
         ...,
         [ 3.7715,  4.7656, -0.0605,  ..., -5.9102, -5.9102, -5.9102],
         [10.9844,  6.9883,  2.6191,  ..., -3.1641, -3.1641, -3.1641],
         [ 0.8276, -0.5967, -0.1122,  ..., -5.9961, -5.9961, -5.9961]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4688,  9.9375,  ..., -3.2461, -3.2461, -3.2461],
        [ 6.8750,  6.5391,  8.6172,  ..., -6.5469, -6.5469, -6.5469],
        [ 4.6992,  7.5781,  6.8672,  ..., -7.3164, -7.3164, -7.3164],
        ...,
        [ 3.7715,  4.7656, -0.0605,  ..., -5.9102, -5.9102, -5.9102],
        [10.9844,  6.9883,  2.6191,  ..., -3.1641, -3.1641, -3.1641],
        [ 0.8276, -0.5967, -0.1122,  ..., -5.9961, -5.9961, -5.9961]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1953,  -3.7285,  ..., -16.9062, -16.9062, -16.9062],
        [ -6.2266,  -6.5625,  -4.4844,  ..., -19.6406, -19.6406, -19.6406],
        [-10.8984,  -8.0156,  -8.7266,  ..., -22.9062, -22.9062, -22.9062],
        ...,
        [-15.4844, -14.4922, -19.3125,  ..., -25.1719, -25.1719, -25.1719],
        [ -9.5625, -13.5625, -17.9375,  ..., -23.7188, -23.7188, -23.7188],
        [-17.3125, -18.7344, -18.2500,  ..., -24.1250, -24.1250, -24.1250]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 21 (dataset index 20): name 'probs' is not defined
Processing sample 22/25 (dataset index: 21)
Processing sample 22 (dataset index 21)
tensor([[[ 4.9023,  6.4688,  9.9297,  ..., -3.2422, -3.2422, -3.2422],
         [ 1.6973,  1.3799,  1.9160,  ..., -7.9922, -7.9922, -7.9922],
         [ 7.6055,  4.3047,  3.1699,  ..., -6.3906, -6.3906, -6.3906],
         ...,
         [ 5.4922,  5.8633,  2.5859,  ..., -6.0469, -6.0469, -6.0469],
         [10.4609,  6.0781,  2.8926,  ..., -2.1562, -2.1562, -2.1562],
         [ 0.2944, -1.1914,  0.7520,  ..., -5.7266, -5.7266, -5.7266]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4688,  9.9297,  ..., -3.2422, -3.2422, -3.2422],
        [ 1.6973,  1.3799,  1.9160,  ..., -7.9922, -7.9922, -7.9922],
        [ 7.6055,  4.3047,  3.1699,  ..., -6.3906, -6.3906, -6.3906],
        ...,
        [ 5.4922,  5.8633,  2.5859,  ..., -6.0469, -6.0469, -6.0469],
        [10.4609,  6.0781,  2.8926,  ..., -2.1562, -2.1562, -2.1562],
        [ 0.2944, -1.1914,  0.7520,  ..., -5.7266, -5.7266, -5.7266]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1992,  -3.7363,  ..., -16.9062, -16.9062, -16.9062],
        [-11.7734, -12.0859, -11.5547,  ..., -21.4531, -21.4531, -21.4531],
        [-10.8281, -14.1328, -15.2656,  ..., -24.8281, -24.8281, -24.8281],
        ...,
        [-16.3125, -15.9453, -19.2188,  ..., -27.8594, -27.8594, -27.8594],
        [ -8.9766, -13.3594, -16.5469,  ..., -21.5938, -21.5938, -21.5938],
        [-17.3438, -18.8281, -16.8906,  ..., -23.3594, -23.3594, -23.3594]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 22 (dataset index 21): name 'probs' is not defined
Processing sample 23/25 (dataset index: 22)
Processing sample 23 (dataset index 22)
tensor([[[ 4.9023,  6.4688,  9.9297,  ..., -3.2441, -3.2441, -3.2441],
         [-3.0273, -1.5537, -2.2734,  ..., -9.5859, -9.5859, -9.5859],
         [ 3.6035,  1.5566,  0.8457,  ..., -9.4453, -9.4453, -9.4453],
         ...,
         [ 7.1250,  5.0859,  0.8145,  ..., -5.0820, -5.0820, -5.0820],
         [ 8.5234,  5.3945,  2.7461,  ..., -2.8438, -2.8438, -2.8438],
         [ 0.5610, -1.2051, -0.1008,  ..., -5.7227, -5.7227, -5.7227]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4688,  9.9297,  ..., -3.2441, -3.2441, -3.2441],
        [-3.0273, -1.5537, -2.2734,  ..., -9.5859, -9.5859, -9.5859],
        [ 3.6035,  1.5566,  0.8457,  ..., -9.4453, -9.4453, -9.4453],
        ...,
        [ 7.1250,  5.0859,  0.8145,  ..., -5.0820, -5.0820, -5.0820],
        [ 8.5234,  5.3945,  2.7461,  ..., -2.8438, -2.8438, -2.8438],
        [ 0.5610, -1.2051, -0.1008,  ..., -5.7227, -5.7227, -5.7227]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1992,  -3.7363,  ..., -16.9062, -16.9062, -16.9062],
        [-14.8984, -13.4219, -14.1406,  ..., -21.4531, -21.4531, -21.4531],
        [-12.4844, -14.5312, -15.2422,  ..., -25.5312, -25.5312, -25.5312],
        ...,
        [-13.0703, -15.1094, -19.3750,  ..., -25.2812, -25.2812, -25.2812],
        [-10.9453, -14.0703, -16.7188,  ..., -22.3125, -22.3125, -22.3125],
        [-18.0156, -19.7812, -18.6875,  ..., -24.3125, -24.3125, -24.3125]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 23 (dataset index 22): name 'probs' is not defined
Processing sample 24/25 (dataset index: 23)
Processing sample 24 (dataset index 23)
tensor([[[ 4.8984,  6.4609,  9.9297,  ..., -3.2402, -3.2402, -3.2422],
         [-3.0312, -1.5566, -2.2773,  ..., -9.5781, -9.5781, -9.5781],
         [ 3.8828,  4.3281,  4.4336,  ..., -5.2383, -5.2383, -5.2383],
         ...,
         [ 9.0234,  6.2891,  6.7422,  ..., -5.2500, -5.2500, -5.2461],
         [ 8.6172,  4.4844,  2.7344,  ..., -3.1543, -3.1543, -3.1543],
         [ 2.7793,  0.0491,  2.3359,  ..., -3.3203, -3.3203, -3.3203]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.8984,  6.4609,  9.9297,  ..., -3.2402, -3.2402, -3.2422],
        [-3.0312, -1.5566, -2.2773,  ..., -9.5781, -9.5781, -9.5781],
        [ 3.8828,  4.3281,  4.4336,  ..., -5.2383, -5.2383, -5.2383],
        ...,
        [ 9.0234,  6.2891,  6.7422,  ..., -5.2500, -5.2500, -5.2461],
        [ 8.6172,  4.4844,  2.7344,  ..., -3.1543, -3.1543, -3.1543],
        [ 2.7793,  0.0491,  2.3359,  ..., -3.3203, -3.3203, -3.3203]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.2031,  -3.7324,  ..., -16.9062, -16.9062, -16.9062],
        [-14.8984, -13.4219, -14.1406,  ..., -21.4375, -21.4375, -21.4375],
        [-10.2578,  -9.8125,  -9.7031,  ..., -19.3750, -19.3750, -19.3750],
        ...,
        [-10.9141, -13.6484, -13.1953,  ..., -25.1875, -25.1875, -25.1875],
        [-10.5156, -14.6484, -16.3906,  ..., -22.2812, -22.2812, -22.2812],
        [-15.8125, -18.5469, -16.2500,  ..., -21.9062, -21.9062, -21.9062]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 24 (dataset index 23): name 'probs' is not defined
Processing sample 25/25 (dataset index: 24)
Processing sample 25 (dataset index 24)
tensor([[[ 4.9023,  6.4688,  9.9297,  ..., -3.2422, -3.2422, -3.2422],
         [ 6.0117,  5.5859,  5.7461,  ..., -4.2188, -4.2188, -4.2188],
         [ 4.0547,  2.2812,  4.2188,  ..., -9.5703, -9.5703, -9.5703],
         ...,
         [ 6.0352,  4.1641,  3.0762,  ..., -3.3438, -3.3438, -3.3438],
         [ 7.2266,  5.1797,  3.5664,  ..., -3.2285, -3.2285, -3.2285],
         [ 1.0615, -0.9199,  1.2129,  ..., -5.4336, -5.4336, -5.4336]]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnsafeViewBackward0>)
tensor([[ 4.9023,  6.4688,  9.9297,  ..., -3.2422, -3.2422, -3.2422],
        [ 6.0117,  5.5859,  5.7461,  ..., -4.2188, -4.2188, -4.2188],
        [ 4.0547,  2.2812,  4.2188,  ..., -9.5703, -9.5703, -9.5703],
        ...,
        [ 6.0352,  4.1641,  3.0762,  ..., -3.3438, -3.3438, -3.3438],
        [ 7.2266,  5.1797,  3.5664,  ..., -3.2285, -3.2285, -3.2285],
        [ 1.0615, -0.9199,  1.2129,  ..., -5.4336, -5.4336, -5.4336]],
       device='cuda:0', dtype=torch.float16, grad_fn=<UnbindBackward0>)
tensor([[ -8.7656,  -7.1992,  -3.7363,  ..., -16.9062, -16.9062, -16.9062],
        [-10.7969, -11.2266, -11.0625,  ..., -21.0312, -21.0312, -21.0312],
        [ -9.8672, -11.6406,  -9.7031,  ..., -23.5000, -23.5000, -23.5000],
        ...,
        [-12.3594, -14.2344, -15.3203,  ..., -21.7344, -21.7344, -21.7344],
        [-11.8828, -13.9297, -15.5391,  ..., -22.3281, -22.3281, -22.3281],
        [-17.1094, -19.0938, -16.9531,  ..., -23.5938, -23.5938, -23.5938]],
       device='cuda:0', dtype=torch.float16, grad_fn=<LogSoftmaxBackward0>)
Error in completion_gradient: name 'probs' is not defined
Error calculating gradient for sample 25 (dataset index 24): name 'probs' is not defined
Processing complete, but no successful results to save. All 25 samples failed.
[main 6779e22] Domain Specific LLM Script Results for Run 60018 (Commit: 8cc63aa)
 2 files changed, 732 insertions(+)
 create mode 100644 slurm-outputs/slurm.60018.abakus11.out
To github.com:ngruenefeld/gradient-uncertainty.git
   8cc63aa..6779e22  main -> main
