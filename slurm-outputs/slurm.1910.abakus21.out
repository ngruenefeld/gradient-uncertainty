slurmstepd-abakus21: error: Unable to create TMPDIR [/tmp/user/24470]: Permission denied
slurmstepd-abakus21: error: Setting TMPDIR to /tmp
Running job with commit: c2ff0691806315ee742fd3cbed7972f6ae04cbe3
[nltk_data] Downloading package stopwords to
[nltk_data]     /home/g/gruenefeld/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package wordnet to
[nltk_data]     /home/g/gruenefeld/nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
Job number: 1910
Dataset: mlsum
Model: llama-2-7b
GPT Model: gpt-4o-mini-2024-07-18
Key mode: keyfile
Sample size: 0
Mode: full
Quantization bits: 4
Full gradient: False
Response only: True
Normalize: False
Perturbation mode: rephrase
Number of perturbations: 3
Loading model in 4-bit precision to reduce memory usage
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [01:28<01:28, 88.04s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:58<00:00, 54.29s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:58<00:00, 59.35s/it]
/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/env/lib/python3.12/site-packages/huggingface_hub/file_download.py:752: UserWarning: Not enough free disk space to download the file. The expected file size is: 0.01 MB. The target location /home/g/gruenefeld/.cache/huggingface/hub/datasets--reciTAL--mlsum/blobs only has 0.00 MB free disk space.
  warnings.warn(
/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/env/lib/python3.12/site-packages/huggingface_hub/file_download.py:752: UserWarning: Not enough free disk space to download the file. The expected file size is: 0.00 MB. The target location /home/g/gruenefeld/.cache/huggingface/hub/datasets--reciTAL--mlsum/blobs only has 0.00 MB free disk space.
  warnings.warn(
The repository for reciTAL/mlsum contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/reciTAL/mlsum.
You can avoid this prompt in future by passing the argument `trust_remote_code=True`.

Do you wish to run the custom code? [y/N] Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/scripts/multiling.py", line 418, in <module>
    main(args)
  File "/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/scripts/multiling.py", line 130, in main
    data = load_multilingual_datasets(dataset_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/utils/utils.py", line 496, in load_multilingual_datasets
    lang_dataset = load_dataset("reciTAL/mlsum", name=lang, streaming=True)[
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/env/lib/python3.12/site-packages/datasets/load.py", line 2062, in load_dataset
    builder_instance = load_dataset_builder(
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/env/lib/python3.12/site-packages/datasets/load.py", line 1782, in load_dataset_builder
    dataset_module = dataset_module_factory(
                     ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/env/lib/python3.12/site-packages/datasets/load.py", line 1664, in dataset_module_factory
    raise e1 from None
  File "/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/env/lib/python3.12/site-packages/datasets/load.py", line 1614, in dataset_module_factory
    ).get_module()
      ^^^^^^^^^^^^
  File "/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/env/lib/python3.12/site-packages/datasets/load.py", line 1264, in get_module
    trust_remote_code = resolve_trust_remote_code(self.trust_remote_code, self.name)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/env/lib/python3.12/site-packages/datasets/load.py", line 137, in resolve_trust_remote_code
    raise ValueError(
ValueError: The repository for reciTAL/mlsum contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/reciTAL/mlsum.
Please pass the argument `trust_remote_code=True` to allow custom code to be run.
