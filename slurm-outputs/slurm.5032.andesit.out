slurmstepd-andesit: error: Unable to create TMPDIR [/tmp/user/24470]: Permission denied
slurmstepd-andesit: error: Setting TMPDIR to /tmp
Running job with commit: 3c678c3a19bddeb73c8ba02227c29fb02bf22488
Running command: python -um scripts.llama "5032" --key_mode "keyfile" --sample_size "0" --test_sample_size "0" --quantization 0 --dataset "mmlu"
[nltk_data] Downloading package stopwords to
[nltk_data]     /home/g/gruenefeld/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package wordnet to
[nltk_data]     /home/g/gruenefeld/nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
Job number: 5032
Key mode: keyfile
Sample size: 0
Normalize: False
Counterfactual: identity
Dataset: mmlu
Model: gpt2
Replacement probability: 1.0
Quantization bits: None (full precision)
Using full train dataset with 11 samples.
Using full test dataset with 322 samples.
Loading model: gpt2
Xet Storage is enabled for this repo, but the 'hf_xet' package is not installed. Falling back to regular HTTP download. For better performance, install the package with: `pip install huggingface_hub[hf_xet]` or `pip install hf_xet`
Using device: cuda
Map:   0%|          | 0/11 [00:00<?, ? examples/s]Map: 100%|██████████| 11/11 [00:00<00:00, 624.69 examples/s]
/home/g/gruenefeld/Documents/GitHub/gradient-uncertainty/scripts/llama.py:304: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Calculating uncertainties for 322 test samples before training (counterfactual mode: identity)...
Processing test sample 1/322 (before training)
Processing test sample 2/322 (before training)
Processing test sample 3/322 (before training)
Processing test sample 4/322 (before training)
Processing test sample 5/322 (before training)
Processing test sample 6/322 (before training)
Processing test sample 7/322 (before training)
Processing test sample 8/322 (before training)
Processing test sample 9/322 (before training)
Processing test sample 10/322 (before training)
Processing test sample 11/322 (before training)
Processing test sample 12/322 (before training)
Processing test sample 13/322 (before training)
Processing test sample 14/322 (before training)
Processing test sample 15/322 (before training)
Processing test sample 16/322 (before training)
Processing test sample 17/322 (before training)
Processing test sample 18/322 (before training)
Processing test sample 19/322 (before training)
Processing test sample 20/322 (before training)
Processing test sample 21/322 (before training)
Processing test sample 22/322 (before training)
Processing test sample 23/322 (before training)
Processing test sample 24/322 (before training)
Processing test sample 25/322 (before training)
Processing test sample 26/322 (before training)
Processing test sample 27/322 (before training)
Processing test sample 28/322 (before training)
Processing test sample 29/322 (before training)
Processing test sample 30/322 (before training)
Processing test sample 31/322 (before training)
Processing test sample 32/322 (before training)
Processing test sample 33/322 (before training)
Processing test sample 34/322 (before training)
Processing test sample 35/322 (before training)
Processing test sample 36/322 (before training)
Processing test sample 37/322 (before training)
Processing test sample 38/322 (before training)
Processing test sample 39/322 (before training)
Processing test sample 40/322 (before training)
Processing test sample 41/322 (before training)
Processing test sample 42/322 (before training)
Processing test sample 43/322 (before training)
Processing test sample 44/322 (before training)
Processing test sample 45/322 (before training)
Processing test sample 46/322 (before training)
Processing test sample 47/322 (before training)
Processing test sample 48/322 (before training)
Processing test sample 49/322 (before training)
Processing test sample 50/322 (before training)
Processing test sample 51/322 (before training)
Processing test sample 52/322 (before training)
Processing test sample 53/322 (before training)
Processing test sample 54/322 (before training)
Processing test sample 55/322 (before training)
Processing test sample 56/322 (before training)
Processing test sample 57/322 (before training)
Processing test sample 58/322 (before training)
Processing test sample 59/322 (before training)
Processing test sample 60/322 (before training)
Processing test sample 61/322 (before training)
Processing test sample 62/322 (before training)
Processing test sample 63/322 (before training)
Processing test sample 64/322 (before training)
Processing test sample 65/322 (before training)
Processing test sample 66/322 (before training)
Processing test sample 67/322 (before training)
Processing test sample 68/322 (before training)
Processing test sample 69/322 (before training)
Processing test sample 70/322 (before training)
Processing test sample 71/322 (before training)
Processing test sample 72/322 (before training)
Processing test sample 73/322 (before training)
Processing test sample 74/322 (before training)
Processing test sample 75/322 (before training)
Processing test sample 76/322 (before training)
Processing test sample 77/322 (before training)
Processing test sample 78/322 (before training)
Processing test sample 79/322 (before training)
Processing test sample 80/322 (before training)
Processing test sample 81/322 (before training)
Processing test sample 82/322 (before training)
